<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥è¯­è¯­æ³•æ‹†åˆ†ç‰¹è®­</title>
    <style>
        body { font-family: "Hiragino Sans", sans-serif; background: #f0f2f5; margin: 0; padding: 20px; text-align: center; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        h1 { color: #2C3E50; }
        .progress-bar { width: 100%; height: 10px; background: #eee; border-radius: 5px; margin: 20px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: #4ECDC4; width: 0%; transition: width 0.3s; }
        
        .sentence-area { 
            min-height: 80px; border: 2px dashed #ccc; border-radius: 10px; 
            margin: 20px 0; padding: 10px; display: flex; flex-wrap: wrap; 
            gap: 10px; justify-content: center; align-items: center; background: #fafafa;
        }
        .sentence-area.correct { border-color: #2ecc71; background: #e8f8f5; }
        
        .word-pool { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 30px; }
        
        .card { 
            padding: 10px 20px; background: white; border: 2px solid #3498db; 
            border-radius: 8px; cursor: pointer; font-size: 1.2rem; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s; user-select: none;
        }
        .card:hover { transform: translateY(-3px); }
        .card.used { opacity: 0.5; pointer-events: none; background: #ddd; border-color: #ccc; }
        
        .slot-card {
            padding: 10px 20px; background: #3498db; color: white; border-radius: 8px; cursor: pointer;
        }

        .feedback { height: 30px; font-weight: bold; margin: 10px 0; }
        .btn { padding: 10px 30px; background: #2C3E50; color: white; border: none; border-radius: 20px; cursor: pointer; font-size: 1rem; margin-top: 20px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ§© è¯­æ³•æ‹†åˆ†ç‰¹è®­</h1>
    <p>ç‚¹å‡»ä¸‹æ–¹å•è¯å¡ç‰‡ï¼Œå°†å…¶æŒ‰æ­£ç¡®è¯­åºå¡«å…¥æ¡†ä¸­ã€‚</p>
    
    <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
    
    <div style="margin-bottom: 10px; color: #666;">ä¸­æ–‡å«ä¹‰: <span id="cn-hint" style="font-weight: bold; color: #333;"></span></div>
    
    <!-- ç­”é¢˜åŒº -->
    <div class="sentence-area" id="answer-box">
        <span style="color:#ccc; font-size: 0.9rem;">(ç‚¹å‡»ä¸‹æ–¹è¯æ±‡ç»„å¥)</span>
    </div>
    
    <div class="feedback" id="feedback"></div>

    <!-- å•è¯æ±  -->
    <div class="word-pool" id="pool"></div>

    <button class="btn" id="next-btn" onclick="nextLevel()">ä¸‹ä¸€é¢˜</button>
</div>

<script>
    const levels = [
        { cn: "æˆ‘åƒè‹¹æœã€‚", parts: ["ç§", "ã¯", "ã‚Šã‚“ã”", "ã‚’", "é£Ÿã¹ã¾ã™"], correct: "ç§ã¯ã‚Šã‚“ã”ã‚’é£Ÿã¹ã¾ã™" },
        { cn: "æ˜å¤©å»å›¾ä¹¦é¦†ã€‚", parts: ["æ˜æ—¥", "å›³æ›¸é¤¨", "ã¸", "è¡Œãã¾ã™"], correct: "æ˜æ—¥å›³æ›¸é¤¨ã¸è¡Œãã¾ã™" },
        { cn: "è¿™æ˜¯æˆ‘çš„ä¹¦ã€‚", parts: ["ã“ã‚Œ", "ã¯", "ç§", "ã®", "æœ¬", "ã§ã™"], correct: "ã“ã‚Œã¯ç§ã®æœ¬ã§ã™" },
        { cn: "ç”°ä¸­å…ˆç”Ÿæ˜¯æ—¥æœ¬äººã€‚", parts: ["ç”°ä¸­ã•ã‚“", "ã¯", "æ—¥æœ¬äºº", "ã§ã™"], correct: "ç”°ä¸­ã•ã‚“ã¯æ—¥æœ¬äººã§ã™" },
        { cn: "åœ¨é£Ÿå ‚åƒåˆé¥­ã€‚", parts: ["é£Ÿå ‚", "ã§", "æ˜¼ã”é£¯", "ã‚’", "é£Ÿã¹ã¾ã™"], correct: "é£Ÿå ‚ã§æ˜¼ã”é£¯ã‚’é£Ÿã¹ã¾ã™" }
    ];

    let currentLevel = 0;
    let currentAnswer = []; // å­˜å‚¨ç©å®¶å½“å‰æ’åºçš„å•è¯

    function initGame() {
        currentLevel = 0;
        loadLevel();
    }

    function loadLevel() {
        const data = levels[currentLevel];
        document.getElementById('cn-hint').innerText = data.cn;
        document.getElementById('feedback').innerText = "";
        document.getElementById('next-btn').style.display = 'none';
        document.getElementById('answer-box').className = 'sentence-area';
        document.getElementById('answer-box').innerHTML = ''; // æ¸…ç©ºç­”é¢˜åŒº
        document.getElementById('progress').style.width = ((currentLevel / levels.length) * 100) + "%";
        
        currentAnswer = [];
        
        // ç”Ÿæˆæ‰“ä¹±çš„å•è¯å¡ç‰‡
        const pool = document.getElementById('pool');
        pool.innerHTML = '';
        
        // ç®€å•çš„æ‰“ä¹±ç®—æ³•
        let shuffled = [...data.parts].sort(() => Math.random() - 0.5);
        
        shuffled.forEach((word, index) => {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerText = word;
            card.dataset.word = word;
            card.onclick = () => selectWord(card);
            pool.appendChild(card);
        });
    }

    function selectWord(cardElement) {
        // ç§»åŠ¨åˆ°ä¸Šæ–¹
        const word = cardElement.dataset.word;
        currentAnswer.push(word);
        
        // è§†è§‰å˜åŒ–
        cardElement.classList.add('used');
        
        // åœ¨ç­”é¢˜åŒºåˆ›å»ºæ–°å¡ç‰‡
        const slot = document.createElement('div');
        slot.className = 'slot-card';
        slot.innerText = word;
        slot.onclick = () => removeWord(slot, cardElement);
        document.getElementById('answer-box').appendChild(slot);
        
        checkAnswer();
    }

    function removeWord(slotElement, originalCard) {
        // ç§»é™¤
        slotElement.remove();
        originalCard.classList.remove('used');
        
        // ä»ç­”æ¡ˆæ•°ç»„ç§»é™¤ (è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œç§»é™¤æœ€åä¸€ä¸ªåŒ¹é…é¡¹)
        const idx = currentAnswer.indexOf(slotElement.innerText);
        if (idx > -1) currentAnswer.splice(idx, 1);
        
        document.getElementById('answer-box').className = 'sentence-area';
        document.getElementById('feedback').innerText = "";
    }

    function checkAnswer() {
        const data = levels[currentLevel];
        const playerSentence = currentAnswer.join("");
        
        // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰è¯éƒ½ç”¨å®Œäº†
        if (currentAnswer.length === data.parts.length) {
            if (playerSentence === data.correct) {
                document.getElementById('answer-box').classList.add('correct');
                document.getElementById('feedback').innerText = "ğŸ‰ æ­£ç¡®ï¼Perfect!";
                document.getElementById('feedback').style.color = "#2ecc71";
                document.getElementById('next-btn').style.display = 'inline-block';
                if(currentLevel === levels.length -1) {
                    document.getElementById('next-btn').innerText = "é€šå…³å®Œæˆ";
                }
            } else {
                document.getElementById('feedback').innerText = "âŒ è¯­åºä¸å¯¹å“¦ï¼Œè¯·æ’¤å›é‡è¯•";
                document.getElementById('feedback').style.color = "#e74c3c";
            }
        }
    }

    function nextLevel() {
        if (currentLevel < levels.length - 1) {
            currentLevel++;
            loadLevel();
        } else {
            alert("æ­å–œä½ å®Œæˆäº†æ‰€æœ‰ç‰¹è®­ï¼");
            initGame();
        }
    }

    initGame();
</script>
</body>
</html>
